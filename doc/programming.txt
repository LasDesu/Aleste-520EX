Малое   предприятие  "ПАТИСОНИК"   завершило   разработку   ПЭВМ
                       ALESTE 520 EX.
 
Для сборки ПК ALESTE 520 EX предлагается комплект:
               - печатная плата со схемой и подробным описанием,
               - запрограммированные ПЗУ.
     ПЭВМ   ALESTE 520 EX    полностью   совместима   с   широко
распространенным компьютером AMSTRAD CPC 6128.
     На  плате  установлен  музыкальный  сопроцессор, контроллер
дисковода,   часы   с   энергонезависимой   памятью.   Применена
расширенная   русифицированная   клавиатура.  Имеется  выход  на
принтер  (Centronics), видеовыход (RGB и черно-белый), системный
разъем, а также входы для подключения мыши (RS-232) и джойстика.
     Дополнительно  нами  разработана внешняя музыкальная плата,
которая  позволяет  получить  качество  звука  аналогичное SOUND
BLASTER на IBM PC.
     Основные комплектующие:  Z80, MC6845,  AY3-8910, K1810ВГ72,
K565РУ7, 27512, К512ВИ1, К1802ИР1, К580ВВ55, К580ВИ53, К580ВВ51.
 
     Режимы работы компьютера:
- AMSTRAD CPC 6128 - работа  с  обширным  зарубежным программным
обеспечением, всевозможные игры с качественной графикой и звуком
 
-  MSX DOS - позволит Вам как использовать  множество прикладных
программ,  так  и  писать  программы  и тексты с возможностью их
переноса на  IBM PC  и обратно благодаря полной совместимости по
дискам.
 
-  CP/M+, CP/M2.2 - работа с множеством прикладных программ.
 
     В  компьютере  реализована  графика  320*200,  каждая точка
своим  цветом,  16  цветов из палитры 64 оттенка и режим графики
высокого  разрешения 640*200, каждая точка своим цветом, 4 цвета
из палитры 64.
 
 
                           ВВЕДЕНИЕ
 
     Представленный  Вашему  вниманию  компьютер ALESTE 520 EX -
это   полупрофессиональная  ЭВМ,  базирующаяся  на  оригинальных
технических  решениях. Использованные решения позволили получить
высокие   технические  характеристики,  простоту  и  удобство  в
обращении с компьютером, его надежность.
     Компьютер  полностью  совместим  с персональным компьютером
AMSTRAD   CPC6128,  но  по  сравнению  с  ним  имеет  улучшенные
графические  возможности,  существенно увеличенный объем памяти,
совместимость   по   дискам   с  операционной  системой  MS  DOS
используемой в компьютерах IBM PC. Это позволит Вам использовать
любое  программное обеспечение на AMSTRAD, а также переносимость
файлов с ALESTE 520 EX на IBM PC и наоборот.
     В  компьютере  предусмотрены  два режима работы : AMSTRAD и
MSX DOS.
     В режиме AMSTRAD обеспечивается совместимость с ПК AMSTRAD.
Для  перехода в этот режим необходимо нажать на кнопку "Shift" и
удерживая  ее в нажатом состоянии кратковременно нажать "СБРОС".
Вы  окажетесь  в  интерпретаторе  языка BASIC, который имеется в
системном ПЗУ компьютера.
     Этот  режим  позволяет  использовать  обширное  программное
обеспечение  ПК  AMSTRAD  широко  распространенного  в  западной
европе  :  всевозможные  игры  с  отличной графикой и прекрасным
звуком,  различные языки программирования, системные программы и
утилиты,   текстовые   и  графические  редакторы,  базы  данных,
издательскую систему PAGE MAKER и многое,многое другое.
     Режим    MSX   DOS   позволяет   максимально   использовать
возможности компьютера и обеспечить дисковую совместимость с IBM
PC.
     MSX DOS   -   это  профессиональная   операционная  система
совместимая  с MS DOS и позволяющая использовать все программное
обеспечение   CP/M.  Под  управлением  MSX  DOS  работают  языки
высокого  уровня  :  Си (MS-C, BDS-C), Turbo Pascal, электронные
таблицы   (Super  Calc),  базы  данных  (DBASE  II),   текстовые
редакторы (Power Writer, ED) и др.
     В  MSX DOS экран может иметь 4 режима, которые обеспечивают
отображение на экране  25 строк текста по  40 или  80 символов в
строке. Два младших из них имеются и в режиме AMSTRAD.
              режим 0 - 640*200 точек,
                        монохромный;
              режим 1 - 320*200 точек,
                        каждая точка может иметь 1 из 4 цветов;
              режим 2 - 640*200 точек,
                        каждая точка может иметь 1 из 4 цветов;
              режим 3 - 320*200 точек,
                        каждая точка может иметь 1 из 16 цветов.
     Причем каждый цвет можно выбрать из 64 оттенков. Эти режимы
позволяют использовать высококачественную графику, такую-же, как
в EGA-адаптере IBM PC.
     В  компьютере установлены часы с энергонезависимой памятью,
которые  обеспечивают  отсчет  времени, дней ,месяцев и лет, как
при  включенном  так  и  выключенном  питании,  а также хранение
установленных в них служебных данных (SETUP).
 
 
                         1.ПАМЯТЬ
 
     Как  известно,  микропроцессор  Z80 использованный в ALESTE
520  EX  может  адресовать  только  64  килобайта  памяти,  а  в
компьютере   ее   установлено  512  килобайт.  Для  того,  чтобы
процессор  справлялся с таким объемом памяти в компьютер введено
специальное  устройство  -  маппер,  которое  выполняет  функции
диспетчера ОЗУ.
     Весь  объем установленного на плату ОЗУ делится на страницы
по 16 килобайт. Таким образом в нашем распоряжении находятся 512
/  16 = 32 страницы памяти, каждая из которых пронумерована от 0
до 31.
     Адресное  пространство  компьютера  (64  килобайта)  в свою
очередь делится на 4 блока по 16 килобайт каждый пронумерованные
от  0  до  3.  Блок  0  содержит ячейки памяти с адреса 0000H по
3FFFH,  блок  1  - с 4000H по 7FFFH, блок 2 - с 8000H по BFFFH и
блок 3 - с C000H по FFFFH.
     Маппер  содержит  4  регистра,  каждый из которых управляет
своим блоком памяти (регистр 0 - управляет блоком 0, регистр 1 -
блоком 1 и т.д.).
     Записывая  номер  страницы  в  соответствующий  регистр, мы
включаем   эту  страницу  в  адресное  пространство  компьютера.
Например,  если  записать  2  в  регистр 1, то с адреса 4000H по
7FFFH будет установлена 2 страница памяти.
     Регистры  маппера  являются  читаемыми,  т.е. можно узнать,
какие  страницы  памяти  подключены  в  данный момент. Для этого
достаточно прочитать номер страницы из регистра маппера с нужным
номером.
     Таким    образом,   маппер   позволяет   очень   эффективно
использовать память компьютера.
     Регистры  маппера  подключены  как  порты  ввода-вывода  по
адресам:
        регистр 0 - 7CXXH,
        регистр 1 - 7DXXH,
        регистр 2 - 7ЕXXH,
        регистр 3 - 7FXXH (XX - означает любое значение).
     При   записи   в   регистры   маппера   необходимо   всегда
устанавливать 2 старших разряда (D6, D7) в единицу.
     При работе  MSX DOS устанавливается следующее распределение
памяти:
     Страницы  с    0  по  3 - экранные     FFFFH ┌────────────┐
страницы,   т.е.  находящаяся   в   них           │ Страница 7 │
информация отображается на экране.          C000H ├────────────┤
     Страницы  с   4  по  7 - системные           │ Страница 6 │
страницы.   Они  подключены  при работе     8000H ├────────────┤
MSX  DOS,   в  них хранятся программы и           │ Страница 5 │
системная информация.                       4000H ├────────────┤
     Страницы   8  и  9 - служебные,  в           │ Страница 4 │
них хранятся части самой MSX DOS            0000H └────────────┘
(страница 8 содержит BIOS, a страница 9
содержит BDOS).
     Остальные   страницы  используется  по  мере  необходимости
(например  текстовый  редактор  Power  Writer  использует их как
буфер  текста)  или  как  электронный  диск.  
 
 
                          3.ЭКРАН.
 
                    3.1 Видеоконтроллер.
 
     В  ПК  ALESTE 520 EX  применена БИС видеоконтроллера MC6845
(аналог   1809ВГ6),   которая  позволила  существенно  сократить
количество микросхем на плате компьютера.
     Она   вырабатывает  адреса  для  экранного  ОЗУ,  формирует
сигналы  строчной  и кадровой частоты. Кроме того, БИС позволяет
программно  устанавливать  адрес начала изображения, необходимые
параметры развертки, а также размер видимого изображения.
     Это  позволяет  использовать в программах аппаратные ролики
экрана  причем  как  в  вертикальном,  так  и  в  горизонтальном
направлениях;  работать  с  несколькими  независимыми страницами
изображения  ( 4 в 0 и 1 режимах, и 2 во 2 и 3 режимах экрана ).
 
                   3.2 Палитра.
 
     В  компьютере  установлено  специальное  ОЗУ называемое ОЗУ
палитры   или  просто палитрой. Оно позволяет придать каждому из
16 цветов один  из 64 оттенков.
     ОЗУ  палитры  содержит  16  ячеек памяти, каждая из которых
соответствует  одному  из  16 цветов. Для придания какому-нибудь
цвету    одного   из   64   оттенков   достаточно   записать   в
соответствующую   ячейку   палитры  6-разрядное  число,  которое
задает необходимый оттенок.
     Цвет в этом 6 разрядном числе кодируется следующим образом:
биты  D5, D4  задают интенсивность красного  цвета,  биты D3, D2
задают  интенсивность зеленого цвета, а D1, D0 - синего цвета.
     Так  например,  для  того,  чтобы сделать 4 цвет фиолетовым
нужно записать в 4 ячейку палитры число 22H (100010).
 
                         3.3 Режимы экрана 0 и 1.
 
     Режим  экрана  0  является  монохромным, т.е в нем возможны
всего 2 цвета, он занимает 16 килобайт памяти и имеет разрешение
640  *  200  точек,  что  позволяет  использовать его для вывода
текстовой информации (25 строк по 80 символов).
     Каждый  байт  в  этом  режиме  содержит информацию о восьми
последовательных  точках.  При  этом старший бит ( D7 ) содержит
информацию о цвете первой точки, D6 - второй точки и т.д.  Таким
образом, одна строка экрана содержит 640 / 8 = 80 байт.
     В  режиме  экрана  1  каждая  точка отображается одним из 4
цветов,  однако  его  разрешение  320  *  200 точек (в текстовом
режиме  25 строк по 40 символов в каждой),   он занимает впамяти
также 16 килобайт
     В  этом  режиме  экрана каждый байт содержит информацию о 4
соседних точках следующим образом:
                            D7, D3 - содержат цвет первой точки;
                            D6, D2 - цвет второй точки;
                            D5, D1 - цвет третьей точки;
                            D4, D0 - цвет четвертой точки.
Одна строка экрана в этом режиме занимает также 320/4 = 80 байт.
Экран  в  режимах  0  и  1 занимает 16К памяти и имеет следующую
структуру:
  ┌───────┬───────┬───────┬───────┬─ ─ ─ ─ ─ ─┬───────┬───────┐
0 │A+    0│A+    1│A+    2│A+    3│           │A+   78│A+   79│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
1 │A+ 2048│A+ 2049│A+ 2050│A+ 2051│           │A+ 2126│A+ 2127│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
2 │A+ 4096│A+ 4097│A+ 4098│A+ 4099│           │A+ 4174│A+ 4175│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
3 │A+ 6144│A+ 6145│A+ 6146│A+ 6147│           │A+ 6222│A+ 6223│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
4 │A+ 8192│A+ 8193│A+ 8194│A+ 8195│           │A+ 8270│A+ 8271│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
5 │A+10240│A+10241│A+10242│A+10243│           │A+10318│A+10319│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
6 │A+12288│A+12289│A+12290│A+12291│           │A+12366│A+12367│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
7 │A+14336│A+14337│A+14338│A+14339│           │A+14414│A+14415│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
8 │A+   80│A+   81│A+   82│A+   83│           │A+  158│A+  159│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
  .       .       .       .       .           .       .       .
  .       .       .       .       .           .       .       .
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
6 │A+  160│A+  161│A+  162│A+  163│           │A+  238│A+  239│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
  .       .       .       .       .           .       .       .
  .       .       .       .       .           .       .       .
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
9 │A+15920│A+15921│A+15922│A+15923│           │A+15998│A+15999│
  └───────┴───────┴───────┴───────┴───────────┴───────┴───────┘
 
                    3.4 Режимы экрана 2 и 3.
 
     Режим  экрана  2 является 4 цветным как и 1 режим, он имеет
такую  же структуру байт как и режим 1, однако разрешение у него
640  *  200  точек  (25  строк  по  80  символов в режиме вывода
текста), поэтому одна строка экрана в этом режиме занимает 640 /
4 = 160 байт.
     В режиме экрана 3 каждая точка отображается одним из 16
цветов,    что   позволяет   использовать   его   для   создания
высококачественной  графики например в играх. Данный режим имеет
разрешение 320 * 200 точек.
     Каждый  байт  в  этом  режиме  содержит  информацию  о двух
соседних  точках.  При  этом  биты  D7,D3,D5,D1  определяют цвет
первой точки, биты D6,D2,D4,D0 - цвет второй точки.
     Таким образом, одна строка экрана содержит  320/2=160 байт.
Экран  в  режимах  2  и  3 занимает 32К памяти и имеет следующую
структуру:
  ┌───────┬───────┬───────┬───────┬─ ─ ─ ─ ─ ─┬───────┬───────┐
0 │A+    0│A+    1│A+    2│A+    3│           │A+  158│A+  159│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
1 │A+16384│A+16385│A+16386│A+16387│           │A+16462│A+16463│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
2 │A+ 4096│A+ 4097│A+ 4098│A+ 4099│           │A+ 4174│A+ 4175│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
3 │A+20480│A+20481│A+20482│A+20482│           │A+20638│A+20639│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
4 │A+ 8192│A+ 8193│A+ 8194│A+ 8195│           │A+ 8270│A+ 8271│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
5 │A+24576│A+24577│A+24578│A+24579│           │A+24734│A+24735│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
6 │A+12288│A+12289│A+12290│A+12291│           │A+12366│A+12367│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
7 │A+28672│A+28673│A+28674│A+28675│           │A+28830│A+28831│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
8 │A+  160│A+  161│A+  162│A+  163│           │A+  318│A+  319│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
  .       .       .       .       .           .       .       .
  .       .       .       .       .           .       .       .
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
6 │A+  320│A+  321│A+  322│A+  323│           │A+  478│A+  479│
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
  .       .       .       .       .           .       .       .
  .       .       .       .       .           .       .       .
  ├───────┼───────┼───────┼───────┼─ ─ ─ ─ ─ ─┼───────┼───────┤
9 │A+32224│A+32225│A+32226│A+32227│           │A+32382│A+32383│
  └───────┴───────┴───────┴───────┴───────────┴───────┴───────┘
              А - это адрес начала экрана.
 
В  режиме  AMSTRAD  существует  еще  один режим экрана 160 * 200
точек,  каждая  из  которых может иметь один из 16 цветов. Объем
экрана   в этом режиме составляет 16 килобайт. Кодировка цвета в
байтах такая  же как и в режиме 3.
 
 
                   4.ЗВУК
 
     В  качестве  источника  звука  в  ПК ALESTE 520 EX применен
звуковой  сопроцессор  AY-3-8910.  Он  позволяет  независимо  от
основного  процессора  генерировать звуковые или шумовые сигналы
по   3-м   каналам   одновременно.   Кроме   того  он  позволяет
использовать огибающие звука различной формы и частоты.
     Это позволяет  генерировать стереозвук высокого качества не
прерывая работы основного процессора.
 
 
                   5.ВНЕШНИЕ УСТРОЙСТВА
 
     К ПК  ALESTE 520 EX  могут подключаться: дисковод, принтер,
джойстик и мышь.
     В  качестве устройства внешней памяти используется дисковод
3,5  дюйма 80 дорожек,  который позволяет получить емкость диска
720 килобайт.
     К ПК может быть подключен любой принтер имеющий стандартный
интерфейс Centronics (МС6312, Д100, МС6337 и т.д.).
     Совместно  с  ПК   ALESTE  520  EX   может   использоваться
манипулятор типа "мышь" совместимый с IBM PC  ( подключающийся к
RS-232 ).
 
 
        КРАТКОЕ ОПИСАНИЕ ВСЕХ ПОРТОВ КОМПЬЮТЕРА ALESTE 520EX
 
     ПК ALESTE 520 EX имеет ПЗУ обьемом 64 Кбайта. Также  как  и
ОЗУ, ПЗУ разделено  на  страницы.  Cтраница  0  ПЗУ  может  быть
подключена с адреса 0000 по 3FFF вместо соответствующей страницы
ОЗУ, а страницы 1,3,7 с адреса C000 по FFFF:
 
                   ┌──────────────┐
                ┌──┴───────────┐ 7│
     FFFF    ┌──┴───────────┐ 3├──┘
             │    ПЗУ 1     ├──┘
     C000    ├──────────────┤
             │     ОЗУ      │
     8000    ├──────────────┤
             │     ОЗУ      │
     4000    ├──────────────┤
             │    ПЗУ 0     │
     0000    └──────────────┘
 
     Число страниц ПЗУ,подключенных по адресу C000 может быть до
256, т.е возможно расширение ПЗУ до  4  Мбайт.  ROM  0  содержит
Amstrad BIOS, страница 1 - Amstrad BASIC, страница 7 - Disk BIOS,
страница 3 - загрузчик MSX DOS.
 
                     Порты ввода-вывода.
 
     7FFFH - Мультипорт (только запись). Имеет 4 регистра.
 #1
┌───┬───┬───┬───┬───┬───┬───┬───┐
│ 0 │ 0 │ X │ ? │ ? │ ? │ ? │ ? │ - Регистр номера цвета
└───┴───┴───┴───┴───┴───┴───┴───┘
              │   └───┴───┴───┴──── Номер цвета
              └──────────────────── 0 - цвет, 1 - бордюр
 #1
┌───┬───┬───┬───┬───┬───┬───┬───┐
│ 0 │ 1 │ R │ r │ G │ g │ B │ b │ - Регистр палитры режим MSX.
└───┴───┴───┴───┴───┴───┴───┴───┘
 
Непосредственное задание яркости лучей по 2 бита на луч
т.е. по 4 яркости. R,G,B - старшие биты   r,g,b - младшие биты.
 #1
┌───┬───┬───┬───┬───┬───┬───┬───┐
│ 0 │ 1 │ X │ ? │ ? │ ? │ ? │ ? │ - Регистр палитры режим
└───┴───┴───┴───┴───┴───┴───┴───┘   AMSTRAD.
              └───┴───┴───┴───┴──── Номер цвета
 
    Таблица соответствия номера цвета яркости лучей.
 
    ╔════════╤═══╤═══╤═══╗    ╔════════╤═══╤═══╤═══╗
    ║ Номер  │   │   │   ║    ║ Номер  │   │   │   ║
    ║        │ R │ G │ B ║    ║        │ R │ G │ B ║
    ║ цвета  │   │   │   ║    ║ цвета  │   │   │   ║
    ╠════════╪═══╪═══╪═══╣    ╠════════╪═══╪═══╪═══╣
    ║        │   │   │   ║    ║        │   │   │   ║
    ║   0    │ 1 │ 1 │ 1 ║    ║   10   │ 0 │ 0 │ 1 ║
    ║   1    │ 1 │ 1 │ 1 ║    ║   11   │ 0 │ 2 │ 1 ║
    ║   2    │ 0 │ 2 │ 1 ║    ║   12   │ 0 │ 2 │ 0 ║
    ║   3    │ 2 │ 2 │ 1 ║    ║   13   │ 0 │ 2 │ 2 ║
    ║   4    │ 0 │ 0 │ 1 ║    ║   14   │ 0 │ 0 │ 0 ║
    ║   5    │ 2 │ 0 │ 1 ║    ║   15   │ 0 │ 0 │ 2 ║
    ║   6    │ 0 │ 1 │ 1 ║    ║   16   │ 0 │ 1 │ 0 ║
    ║   7    │ 2 │ 1 │ 1 ║    ║   17   │ 0 │ 1 │ 2 ║
    ║   8    │ 2 │ 0 │ 1 ║    ║   18   │ 1 │ 0 │ 1 ║
    ║   9    │ 2 │ 2 │ 1 ║    ║   19   │ 1 │ 2 │ 1 ║
    ║   A    │ 2 │ 2 │ 0 ║    ║   1A   │ 1 │ 2 │ 0 ║
    ║   B    │ 2 │ 2 │ 2 ║    ║   1B   │ 1 │ 2 │ 2 ║
    ║   C    │ 2 │ 0 │ 0 ║    ║   1C   │ 1 │ 0 │ 0 ║
    ║   D    │ 2 │ 0 │ 2 ║    ║   1D   │ 1 │ 0 │ 2 ║
    ║   E    │ 2 │ 1 │ 0 ║    ║   1E   │ 1 │ 1 │ 0 ║
    ║   F    │ 2 │ 1 │ 2 ║    ║   1F   │ 1 │ 1 │ 2 ║
    ║        │   │   │   ║    ║        │   │   │   ║
    ╚════════╧═══╧═══╧═══╝    ╚════════╧═══╧═══╧═══╝
 #2
┌───┬───┬───┬───┬───┬───┬───┬───┐
│ 1 │ 0 │ X │ X │ ? │ ? │ ? │ ? │
└───┴───┴───┴───┴───┴───┴───┴───┘
                  │   │   └───┴──── Режим экрана
                  │   └──────────── 0 - ПЗУ,
                  │                 1 - ОЗУ с 0000H по 3FFFH
                  └──────────────── 0 - ПЗУ,
                                    1 - ОЗУ с C000H по FFFFH
 #3
┌───┬───┬───┬───┬───┬───┬───┬───┐
│ 1 │ 1 │ X │ X │ X │ 0 │ ? │ ? │ - Регистр жестких конфигураций
└───┴───┴───┴───┴───┴───┴───┴───┘   ОЗУ режима AMSTRAD
           ┌───┬───┬───┬──┴───┴──── Номер конфигурации
           │   │   │   │
╔════════╤═══╤═══╤═══╤═══╗
║Содержи-│   │   │   │   ║
║мое     │ 0 │ 1 │ 2 │ 3 ║
║регистра│   │   │   │   ║
╠════════╪═══╪═══╪═══╪═══╣
║ c C000 │ 3 │ 7 │ 7 │ 7 ║
╟────────┼───┼───┼───┼───╢
║ c 8000 │ 2 │ 2 │ 6 │ 2 ║
╟────────┼───┼───┼───┼───╢
║ c 4000 │ 1 │ 1 │ 5 │ 3 ║
╟────────┼───┼───┼───┼───╢
║ c 0000 │ 0 │ 0 │ 4 │ 0 ║
╚════════╧═══╧═══╧═══╧═══╝
 #3
┌───┬───┬───┬───┬───┬───┬───┬───┐
│ 1 │ 1 │ ? │ ? │ ? │ 1 │ ? │ ? │  -  Регистр  номера  страницы
└───┴───┴───┴───┴───┴───┴───┴───┘     ОЗУ ( при MAPMOD=0 ).
          └───┴───┼───────┴───┴─────  Номер страницы, причем 0 -
                  │                   страница номер 4;  1 - 5 и
                  │                   т.д. Страница подключается
╔════════╤══════╤══════╤══════╤══════╗с 4000H.  В  ALESTE есть 8
║ Адрес  │      │      │      │      ║страниц, это 128К плюс 64К
║        │ 0000 │ 4000 │ 8000 │ С000 ║системных страниц 0-3.
║страницы│      │      │      │      ║Таким  образом,  в  режиме
╠════════╪══════╪══════╪══════╪══════╣AMSTRAD доступно 192К.
║Страница│      │      │      │      ║
║  ОЗУ   │   0  │   ?  │   2  │   3  ║
║        │      │      │      │      ║
╚════════╧══════╧══════╧══════╧══════╝
 
Регистр #3 в режиме MSX превращается в МАППЕР описанный выше.
 
 
     DFFFH - ROMPORT (только запись)
     Он содержит номер страницы ПЗУ включаемой с адреса  C000
     1 -Basic 7 -Disc 3 -Boot
 
     FABFH - EXTEND PORT (только запись)
Используется только BIOS.
Доступ для пользователя в этот порт запрещен.
 
                 Порты видеоконтроллера M6845:
     BCFFH - запись номера регистра (W)
     BDFFH - данные (R/W)
╔════════╤═════════════════╤══════╤════════════════════════════╗
║ Номер  │  Содержимое     │Чтение│                            ║
║        ╞════════╤════════╡  /   │       Функции              ║
║регистра│реж. 0,1│реж. 2,3│Запись│                            ║
╠════════╪════════╪════════╪══════╪════════════════════════════╣
║    0   │    3F  │    6B  │ -/W  │ Полная горизонталь (тактов)║
║    1   │    28  │    50  │ -/W  │ Видимая строка (символов)  ║
║    2   │    2E  │    52  │ -/W  │ Положение строчного ГИ     ║
║    3   │    8E  │    8E  │ -/W  │ Длительность СГИ           ║
║    4   │    1F  │    1F  │ -/W  │ Полная вертикаль (строк)   ║
║    5   │    06  │    06  │ -/W  │ Дополнение вертикали       ║
║    6   │    19  │    19  │ -/W  │ Видимая вертикаль (строк)  ║
║    7   │    1B  │    1B  │ -/W  │ Положение кадрового ГИ     ║
║    8   │    00  │    00  │ -/W  │ Тип развертки              ║
║    9   │    07  │    07  │ -/W  │ Строк в символе            ║
║   10   │    00  │    00  │ -/W  │ Начало курсора (строк)     ║
║   11   │    00  │    00  │ -/W  │ Окончание курсора (строк)  ║
║   12   │    30  │    30  │ R/W  │ Начало изображения ст.байт ║
║   13   │    00  │    00  │ R/W  │ Начало изображения мл.байт ║
║   14   │    00  │    00  │ R/W  │ Позиция курсора ст.байт    ║
║   15   │    00  │    00  │ R/W  │ Позиция курсора мл.байт    ║
║   16   │    ──  │    ──  │ R/-  │ Позиция светового пера     ║
║   17   │    ──  │    ──  │ R/-  │ старший и младший байты    ║
╚════════╧════════╧════════╧══════╧════════════════════════════╝
У   видеоконтроллеров    некоторых   фирм-изготовителей   чтение
возможно из всех регистров,  но  расчитывать в программах на это
нельзя.  Цвет бордюра в режимах 2, 3  должен быть черным,  иначе
при  использовании  в  качестве  монитора   бытового  телевизора
конденсаторы   запоминающие  уровень  черного не будут  успевать
разряжаться и цвета изображения будут искажаться. Происходит это
из-за уменьшения длительности гасящих импульсов.
 
                Параллельный порт 580ВВ55:
     F4FFH - канал А (запись) PA0-PA7 - шина данных AY 8910,
                                        512ВИ1, 580ВИ53.
     F5FFH - канал В (чтение) PВ0 -     кадровый СИ (1)
                              PВ1 -     DISCINT (1 - окончание
                                        операции с диском)
                              PВ6 -     BUSY (0 - принтер готов)
     F6FFH - канал С (запись) PC0-PC3 - номер строки матрицы
                                        клавиатуры
                              PC4 -     строб принтера  (1)
                              PC6 -     ВC1 AY 8910
                              PC7 -     ВDIR AY 8910
     F7FFH - регистр управляющего слова.
Если D7 = 1, то регистр управляющего слова задает режим и
функции каналов ввода-вывода микросхемы:
    D0    - функции канала C (PC0-PC3): 1 - Ввод, 0 - Вывод
    D1    - функции канала B (PB0-PB7): 1 - Ввод, 0 - Вывод
    D2    - режим канала B:             0 - реж.0,1 - реж.1
    D3    - функции канала C (PC4-PC7): 1 - Ввод, 0 - Вывод
    D4    - функции канала A (PA0-PA7): 1 - Ввод, 0 - Вывод
    D5,D6 - режим канала A:            00 - режим 0
                                       01 - режим 1
                                       10 - режим 2
                                       11 - режим 2
Если  D7 = 1,  то  регистр  управляющего слова выполняет функции
побитной установки разрядов канала C:
            D0 - команда:   1 - установить бит, 0 - сбросить бит
            D1-D3 определяют номер бита канала C
 
     Звуковой сопроцессор  AY-3-8910  ( тактовая частота 1МГц ).
Для  доступа к звуковому  сопроцессору  имеются  функции  BIOS -
WR_PSG,  RD_PSG.
╔════════╤═════════════════════════════════════════════════════╗
║ Номер  │           Выполняемые функции                       ║
║регистра│                                                     ║
╠════════╪═════════════════════════════════════════════════════╣
║    0   │ Частота канала A, младший байт (D0-D7)              ║
║    1   │ Частота канала A, старший байт (D0-D3)              ║
║    2   │ Частота канала B, младший байт (D0-D7)              ║
║    3   │ Частота канала B, старший байт (D0-D3)              ║
║    4   │ Частота канала C, младший байт (D0-D7)              ║
║    5   │ Частота канала C, старший байт (D0-D3)              ║
║    6   │ Частота генератора шума                             ║
║    7   │ Микшер:  D0 - звук в канале A  (0 - Оn, 1 - Off)    ║
║        │          D1 - звук в канале B  (0 - On, 1 - Off)    ║
║        │          D2 - звук в канале C  (0 - On, 1 - Off)    ║
║        │          D3 - шум в канале A   (0 - On, 1 - Off)    ║
║        │          D4 - шум в канале B   (0 - On, 1 - Off)    ║
║        │          D5 - шум в канале C   (0 - On, 1 - Off)    ║
║        │          D6 - порт A  (0 - чтение, 1 - запись)      ║
║        │          D7 - порт B  (0 - чтение, 1 - запись)      ║
║    8   │ Громкость в канале A                                ║
║    9   │ Громкость в канале B                                ║
║   10   │ Громкость в канале C                                ║
║   11   │ Период огибающей, младший байт                      ║
║   12   │ Период огибающей, старший байт                      ║
║   13   │ Вид огибающей:                                      ║
║        │                                                     ║
║        │   D3 D2 D1 D0                                       ║
║        │                \                                    ║
║        │    0  0  -  -   \____________                       ║
║        │                                                     ║
║        │                 /│                                  ║
║        │    0  1  -  -  / │___________                       ║
║        │                                                     ║
║        │                \ │\ │\ │\ │\                        ║
║        │    1  0  0  0   \│ \│ \│ \│ \                       ║
║        │                                                     ║
║        │                \                                    ║
║        │    1  0  0  1   \____________                       ║
║        │                                                     ║
║        │                \  /\  /\  /\                        ║
║        │    1  0  1  0   \/  \/  \/  \                       ║
║        │                   ___________                       ║
║        │                \ │                                  ║
║        │    1  0  1  1   \│                                  ║
║        │                                                     ║
║        │                 /│ /│ /│ /│ /│                      ║
║        │    1  1  0  0  / │/ │/ │/ │/ │                      ║
║        │                  ____________                       ║
║        │                 /                                   ║
║        │    1  1  0  1  /                                    ║
║        │                                                     ║
║        │                 /\  /\  /\  /                       ║
║        │    1  1  1  0  /  \/  \/  \/                        ║
║        │                                                     ║
║        │                 /│                                  ║
║        │    1  1  1  1  / │___________                       ║
║        │                                                     ║
║   14   │ Порт A (чтение) - клавиатура                        ║
║   15   │ Порт B (запись) - данные для принтера (Centronics)  ║
╚════════╧═════════════════════════════════════════════════════╝
 
              Часы реального времени ( 512ВИ1 ).
Для доступа в регистры часов существуют функции BIOS -
WR_CLOCK, RD_CLOCK.
╔════════╤═════════════════════════════════════════════════════╗
║ Номер  │           Выполняемые функции                       ║
║регистра│                                                     ║
╠════════╪═════════════════════════════════════════════════════╣
║    0   │ Секунды часов                                       ║
║    1   │ Секунды будильника                                  ║
║    2   │ Минуты часов                                        ║
║    3   │ Минуты будильника                                   ║
║    4   │ Часы                                                ║
║    5   │ Часы будильника                                     ║
║    6   │ День недели                                         ║
║    7   │ Число                                               ║
║    8   │ Месяц                                               ║
║    9   │ Год                                                 ║
║   10   │ Регистр A                                           ║
║   11   │ Регистр B                                           ║
║   12   │ Регистр C                                           ║
║   13   │ Регистр D                                           ║
║ 14..63 │ Свободная память ( используется для конфигурации ). ║
╚════════╧═════════════════════════════════════════════════════╝
 
Регистр A:
          D7    1 - происходит цикл обновления (только чтение)
          D6-D4 частота кварцевого резонатора (010 - 32768 Гц)
          D3-D0 частота прерываний и сигнала SQW
 
Регистр В:
          D7    1- запрещает обновление
          D6    1- разрешение прерывания с периодом,
                   задаваемым регистром A
          D5    1- разрешение прерывания от будильника
          D4    1- разрешение прерывания по окончании
                   цикла обновления
          D3    1- разрешение выдачи сигнала на выход SQW
          D2    1- данные о времени и дате в двоичном виде
                0- данные о времени в двоично-десятичном виде
          D1    1- 24 часовой режим счета
                0- 12 часовой режим счета
          D0    1- разрешение автоматического перехода
                   на летнее время
 
Регистр C: (только чтение)
          D7    1- установлено прерывание
          D6       устанавливается в 1 фронтом сигнала SQW
          D5    1- при совпадении времени и будильника
          D4       устанавливается в 1 по окончанию цикла
                   обновления
 
Регистр D: (только чтение)
          D7- сбрасывается  в 0 при пропадании питания,
              устанавливается в 1 после первого чтения
 
        Порты контроллера дисковода ( 1810ВГ72 ).
 
     FA7EH - запись D0- 0 -MOTOR OFF  1 -MOTOR ON
     FB7EH - чтение регистра статуса
     FB7FH - чтение / запись данных
 
                      Матрица клавиатуры.
 
╔═════╤═══════════════════════════════════════════════════════╗
║ N   │                     Данные                            ║
║ стр.│  D7     D6     D5     D4     D3     D2     D1     D0  ║
╟─────┼───────────────────────────────────────────────────────╢
║  0  │  D.   ENTER    D3     D6     D9    DOWN  RIGNT    UP  ║
║     │                                                       ║
║  1  │  D0     D2     D1     D5     D8     D7    ALT    LEFT ║
║     │                                                       ║
║  2  │  CTRL   \     SHIFT   D4     ]    RETURN   [      BS  ║
║     │                                                       ║
║  3  │  .      /      :      ;      P      @      -      f=  ║
║     │                                                       ║
║  4  │  ,      M      K      L      I      O      9      0   ║
║     │                                                       ║
║  5  │SPASE    N      J      H      Y      U      7      8   ║
║     │                                                       ║
║  6  │  V      B      F      G      T      R      5      6   ║
║     │                                                       ║
║  7  │  X      C      D      S      W      E      3      4   ║
║     │                                                       ║
║  8  │  Z     CAPS    A     TAB     Q     ESC     2      1   ║
║     │                                                       ║
║  9  │ DEL    R/L   J.F.1  J.F.2   J.R.   J.L.   J.D.   J.U. ║
║     │                                                       ║
║ 10  │ F1/6   F2/7   F3/8   F4/9   F5/10  HELP   INS     ъ   ║
╚═════╧═══════════════════════════════════════════════════════╝
 
ВНИМАНИЕ!    Мы настоятельно рекомендуем не обращаться к портам
ввода-вывода  непосредственно.   Ползуйтесь для этого функциями
BIOS.  Кроме того, что это намного облегчит написание программ,
будет обеспечена  работоспособность Ваших программ на следующих
версиях компьютера ALESTE.
 
                 Magic sound short description
 
When I/O memory  access  and  A5  and  A10  are  equal  0  then
MagicSound address space enabled.
╔════════╤═════════════════════════════════════════════════════╗
║ Adress │           Description                               ║
║10 5 9 8│                                                     ║
╠════════╪═════════════════════════════════════════════════════╣
║ 0 0 0 0│ WR/RD 8237                                          ║
║        │                                                     ║
║        │ TC produce NMI                                      ║
║        │ A3-0 select register                                ║
║        │                                                     ║
║ 0 0 0 1│ WR    8254                                          ║
║        │                                                     ║
║        │ Timers do not work after reset, and start working   ║
║        │ After first write to MS MAPPER                      ║
║        │ A1-0 Select register inside ICs                     ║
║        │ A2 equal 0 select Timer 1 (channels 1,2,3)          ║
║        │ A3 equal 0 select Timer 2 (channel 4 and L/R)       ║
║        │ L/R used for DAC only                               ║
║        │                                                     ║
║ 0 0 1 0│ WR Volume                                           ║
║        │                                                     ║
║        │ A1-0 select channel(1,2,3,4)                        ║
║        │ D5-0 is volume                                      ║
║        │                                                     ║
║ 0 0 1 1│ WR MAPPER                                           ║
║        │                                                     ║
║        │ A1-0 select channel(1,2,3,4)                        ║
║        │ D4-0 is page num of ALESTE memory                   ║
║        │                                                     ║
╚════════╧═════════════════════════════════════════════════════╝
